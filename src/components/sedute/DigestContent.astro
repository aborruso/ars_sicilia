---
import { marked } from 'marked';

interface Props {
  digest: string | null;
}

const { digest } = Astro.props;

const htmlContent = digest ? marked.parse(digest) : null;
---

{digest ? (
  <section class="mt-8">
    <h2 class="text-2xl font-bold mb-4">Sintesi della seduta</h2>
    <aside class="mb-6 p-4 bg-yellow-50 border border-yellow-200 rounded-lg" role="note" aria-label="Avviso: contenuto generato automaticamente">
      <p class="text-sm text-yellow-900">
        ⚠️ <strong>ATTENZIONE:</strong> Il testo di questo digest è stato generato automaticamente da un LLM, analizzando l'audio trascritto della seduta. Quindi potrebbe contenere errori e allucinazioni.
      </p>
    </aside>
    <div
      class="prose prose-gray max-w-none bg-white p-6 rounded-lg shadow-sm"
      set:html={htmlContent}
    />
  </section>
) : (
  <div class="mt-8 p-4 bg-yellow-50 border border-yellow-200 rounded-lg">
    <p class="text-sm text-yellow-800">
      ℹ️ Sintesi non disponibile per questo video (trascrizione non generata o video troppo breve).
    </p>
  </div>
)}
